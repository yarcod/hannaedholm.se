"use strict";var SearchkitDefault=(()=>{var X=Object.create;var x=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var ne=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),se=(t,e)=>{for(var r in e)x(t,r,{get:e[r],enumerable:!0})},j=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ee(e))!re.call(t,s)&&s!==r&&x(t,s,{get:()=>e[s],enumerable:!(n=q(e,s))||n.enumerable});return t};var ie=(t,e,r)=>(r=t!=null?X(te(t)):{},j(e||!t||!t.__esModule?x(r,"default",{value:t,enumerable:!0}):r,t)),ae=t=>j(x({},"__esModule",{value:!0}),t);var I=ne((Le,B)=>{"use strict";var oe=function(e){return ue(e)&&!ce(e)};function ue(t){return!!t&&typeof t=="object"}function ce(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||fe(t)}var le=typeof Symbol=="function"&&Symbol.for,ge=le?Symbol.for("react.element"):60103;function fe(t){return t.$$typeof===ge}function he(t){return Array.isArray(t)?[]:{}}function F(t,e){return e.clone!==!1&&e.isMergeableObject(t)?A(he(t),t,e):t}function pe(t,e,r){return t.concat(e).map(function(n){return F(n,r)})}function de(t,e){if(!e.customMerge)return A;var r=e.customMerge(t);return typeof r=="function"?r:A}function ye(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return t.propertyIsEnumerable(e)}):[]}function N(t){return Object.keys(t).concat(ye(t))}function k(t,e){try{return e in t}catch{return!1}}function me(t,e){return k(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function be(t,e,r){var n={};return r.isMergeableObject(t)&&N(t).forEach(function(s){n[s]=F(t[s],r)}),N(e).forEach(function(s){me(t,s)||(k(t,s)&&r.isMergeableObject(e[s])?n[s]=de(s,r)(t[s],e[s],r):n[s]=F(e[s],r))}),n}function A(t,e,r){r=r||{},r.arrayMerge=r.arrayMerge||pe,r.isMergeableObject=r.isMergeableObject||oe,r.cloneUnlessOtherwiseSpecified=F;var n=Array.isArray(e),s=Array.isArray(t),o=n===s;return o?n?r.arrayMerge(t,e,r):be(t,e,r):F(e,r)}A.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,s){return A(n,s,r)},{})};var Ae=A;B.exports=Ae});var De={};se(De,{ESTransporter:()=>_,MatchFilter:()=>Fe,TermFilter:()=>C,default:()=>P});var U=ie(I());var C=(t,e)=>({term:{[t]:e}}),Fe=(t,e)=>({match:{[t]:e}});var S=(t,e)=>t.find(n=>typeof n=="string"?n===e:n.attribute===e)||null,Q=t=>typeof t!="string"&&!!t.nestedPath;var D=(t,e)=>{var n;let r=typeof e=="string"?e:e.attribute;return t.includes(r)?"string":((n=t.find(s=>(s==null?void 0:s.attribute)===r))==null?void 0:n.type)||"string"},w=t=>t.reduce((e,r)=>[...e,JSON.stringify({index:r.indexName}),`
`,JSON.stringify(r.body),`
`],[]).join("");var H=(t,e)=>{let{params:r={}}=t,{numericFilters:n}=r;return Array.isArray(n)?n.reduce((s,o)=>{let i,c,l,a,g="",u=o.match(/([\w\.\_\-]+)\s*(\=|\!\=|\>|\>\=|\<|\<\=)\s*(-?\d+)/);if(u)[i,c,l,a]=u;else{if(u=o.match(/([\w\.\_\-]+):\s*(-?\d+)\s*([Tt][Oo])\s*(-?\d+)/),!u)throw new Error(`Numeric filter "${o}" could not be parsed. It should either be in the format "attributeName operator operand" or "attributeName: lowerBound TO upperBound"`);[i,c,a,l,g]=u}let f=R(e.facet_attributes||[],e.filter_attributes||[])[c],p=(d,m,b)=>{if(m==="=")return{term:{[d]:b}};if(m==="!=")return{bool:{must_not:{term:{[d]:b}}}};if(m===">")return{range:{[d]:{gt:b}}};if(m===">=")return{range:{[d]:{gte:b}}};if(m==="<")return{range:{[d]:{lt:b}}};if(m==="<=")return{range:{[d]:{lte:b}}};if(m.toUpperCase()==="TO")return{range:{[d]:{gte:b,lte:g}}}},y=[];if(f.nestedPath){let d=s.find(m=>m.nested.path===f.nestedPath);d?d.nested.query.bool.filter.push(p(f.nestedPath+"."+f.field,l,a)):y.push({nested:{path:f.nestedPath,inner_hits:{},query:{bool:{filter:[p(f.nestedPath+"."+f.field,l,a)]}}}})}else y.push(p(f.field,l,a));return[...s,...y]},[]):[]},R=(t,e)=>[...e,...t].reduce((r,n)=>{let s=typeof n=="string"?{attribute:n,field:n,type:"string"}:n;return{...r,[s.attribute]:s}},{}),L=(t,e)=>{let{params:r={}}=t,{facetFilters:n}=r;if(!Array.isArray(n))return[];let s=R(e.facet_attributes||[],e.filter_attributes||[]);return n.reduce((o,i)=>{if(Array.isArray(i))return[...o,{bool:{should:i.reduce((c,l)=>{let[a,g]=l.split(":"),u=s[a];if(!u)throw new Error(`Facet "${a}" not found in configuration. Add configuration to either facet_attributes or filter_attributes.`);let h=u.field,f=u.filterQuery||C;if(Q(u)){let p=c.find(y=>y.nested&&y.nested.path===u.nestedPath);return p?(p.nested.query.bool.should.push(f(`${u.nestedPath}.${u.field}`,g)),c):[...c,{nested:{inner_hits:{},path:u.nestedPath,query:{bool:{should:[f(`${u.nestedPath}.${u.field}`,g)]}}}}]}return[...c,f(h,g)]},[])}}];if(typeof i=="string"){let[c,l]=i.split(":"),a=s[c];if(!a)throw new Error(`Facet "${c}" not found in configuration. Add configuration to either facet_attributes or filter_attributes.`);let g=a.filterQuery||C;if(Q(a)&&a.nestedPath){let u=o.find(h=>h.nested&&h.nested.path===a.nestedPath+".");return u?(u.nested.query.bool.should.push(g(`${a.nestedPath}.${a.field}`,l)),o):[...o,{nested:{inner_hits:{},path:a.nestedPath,query:{bool:{should:[g(`${a.nestedPath}.${a.field}`,l)]}}}}]}return[...o,g(a.field,l)]}},[])},E=(t=[],e=[],r)=>{let n=/([\w\.\-]+)\:/gi,s=R(t,e);return r.replace(n,(o,i)=>{if(!s[i])throw new Error(`Attribute "${i}" is not defined as an attribute in the facet or filter search settings`);if(s[i].nestedPath)throw new Error(`Attribute "${i}" is a nested field and cannot be used as a filter. Nested fields are supported in facetFilers or numericFilters.`);return s[i].field+":"})},O=(t,e)=>{let{params:r={}}=t,{filters:n}=r;return!n||n===""?[]:[{query_string:{query:E(e.facet_attributes,e.filter_attributes,n)}}]},W=(t,e)=>{if(!e.geo_attribute)return[];let{params:r={}}=t,{aroundLatLng:n,aroundRadius:s,insideBoundingBox:o}=r;if(o)return[Se(o,e.geo_attribute)];if(n){let i=n.split(",");return[{geo_distance:{distance:s||"1000m",[e.geo_attribute]:{lat:i[0],lon:i[1]}}}]}return[]};function Se(t,e){let r=(n,s,o,i)=>({geo_bounding_box:{[e]:{top_right:{lat:n,lon:s},bottom_left:{lat:o,lon:i}}}});if(typeof t=="string"){let[n,s,o,i]=t.split(",");return r(parseFloat(n),parseFloat(s),parseFloat(o),parseFloat(i))}else if(Array.isArray(t))return{bool:{should:t.map(s=>{let[o,i,c,l]=s;return r(parseFloat(o),parseFloat(i),parseFloat(c),parseFloat(l))})}}}function z(t,e){if(e.sorting&&Object.keys(e.sorting).length>0){let r=Object.keys(e.sorting).find(s=>{if(t.indexName.endsWith(s))return!0});if(!r&&!e.sorting.default)return{};let n=r?e.sorting[r]:e.sorting.default;return Array.isArray(n)?{sort:n.map(s=>({[s.field]:s.order}))}:{sort:{[n.field]:n.order}}}return{}}function K(t,e){if(e.sorting&&Object.keys(e.sorting).length>0){let r=Object.keys(e.sorting).find(n=>{if(t.endsWith(n))return!0});if(r)return t.replace(r,"")}return t}var Qe=t=>{let e=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");return e=e.split("").map(r=>/[a-z]/.test(r)?`[${r}${r.toUpperCase()}]`:r).join(""),e=`${e}.*`,t.length>2&&(e=`([a-zA-Z]+ )+?${e}`),e},_e=(t,e,r)=>{let n=r&&r.length>0?{include:Qe(r)}:{};return{terms:{field:t,size:e,...n}}},$=(t,e,r)=>{let n={},s=typeof t!="string"&&t.facetQuery?t.facetQuery:_e,o=(i,c)=>(typeof t=="string"||t.type==="string"?n={[i]:s(c,e,r)}:t.type==="numeric"&&(n={[i+"$_stats"]:{stats:{field:c}},[i+"$_entries"]:s(c,e,r)}),n);return typeof t=="string"?o(t,t):Q(t)?{[`${t.nestedPath}.`]:{nested:{path:t.nestedPath},aggs:o(t.attribute,`${t.nestedPath}.${t.field}`)}}:o(t.attribute,t.field)},xe=(t,e,r)=>{let{params:n={},type:s}=t,{facets:o,maxValuesPerFacet:i,facetName:c,facetQuery:l}=n,a=i||10,g=e.facet_attributes||[];if(c){let u=S(g,c);return u?$(u,a,l):null}else if(Array.isArray(o)){let u=e.facet_attributes||[];return r.facetAttributesOrder&&(u=r.facetAttributesOrder.map(f=>S(e.facet_attributes||[],f)).filter(f=>f!==null)),(o[0]==="*"?u:o.map(f=>S(e.facet_attributes||[],f)).filter(f=>f!==null)).reduce((f,p)=>(0,U.default)(f,$(p,a,"")),{})||{}}else if(typeof o=="string"){let u=S(e.facet_attributes||[],o);return u?$(u,a,""):{}}};function Ce(t,e){return e.touched?{function_score:{query:{pinned:{ids:e.pinnedDocs,organic:t}},functions:e.boostFunctions}}:t}function we(t,e){let r=n=>e.map(s=>typeof s=="string"?s:`${s.field}^${(s.weight||1)*n}`);return{bool:{should:[{bool:{should:[{multi_match:{query:t,fields:r(1),fuzziness:"AUTO:4,8"}},{multi_match:{query:t,fields:r(.5),type:"bool_prefix"}}]}},{multi_match:{query:t,type:"phrase",fields:r(2)}}]}}}var Ee=(t,e,r,n)=>{var h,f,p;let s=r.query,o=e.search_attributes,i=[...L(t,e),...H(t,e),...O(t,e),...W(t,e),...((h=n==null?void 0:n.getBaseFilters)==null?void 0:h.call(n))||[],...r.baseFilters],c=typeof s=="string"&&s!==""?n!=null&&n.getQuery?n.getQuery(s,o,e):we(s,o):{match_all:{}},l=typeof(n==null?void 0:n.getKnnQuery)=="function",a=((f=n==null?void 0:n.getQuery)==null?void 0:f.call(n,s,o,e))===!1;(a||l&&s==="")&&(c={match_all:{}});let g={bool:{filter:i,must:r.touched?Ce(c,r):c}},u=null;return l&&s!==""&&(u={filter:i,...((p=n==null?void 0:n.getKnnQuery)==null?void 0:p.call(n,s,o,e))||{}}),s!==""&&a&&l&&u?{knn:u}:{query:g,knn:u||void 0}},Me=(t,e)=>{let{params:r={}}=t,n=r.hitsPerPage==null?20:r.hitsPerPage;return{size:n,from:(r.page||0)*n}},Pe=(t,e)=>{let{params:r={}}=t,{attributesToRetrieve:n}=r,s=new Set([...e.result_attributes||[],...e.highlight_attributes||[],...e.geo_attribute?[e.geo_attribute]:[]]);return{_source:{includes:Array.from(s)}}},M=t=>{let e={attribute:t,length:100};if(!t.includes(":"))return e;let r=t.match(/(.+)\:(\d+)/);return r?{attribute:r[1],length:parseInt(r[2])}:e},Re=(t,e)=>{var i,c;let{params:r={}}=t,{attributesToHighlight:n}=r,s=((i=e.highlight_attributes)==null?void 0:i.reduce((l,a)=>({...l,[a]:{number_of_fragments:0}}),{}))||{},o=((c=e.snippet_attributes)==null?void 0:c.reduce((l,a)=>({...l,[M(a).attribute]:{number_of_fragments:5,fragment_size:M(a).length}}),{}))||{};return{highlight:{pre_tags:["<em>"],post_tags:["</em>"],fields:{...s,...o}}}};function J(t,e,r,n){return{aggs:xe(t,e,r),...Ee(t,e,r,n),...Me(t,e),...Pe(t,e),...Re(t,e),...z(t,e)}}function V(t,e){let r=new RegExp(e,"gi");return t.replace(r,n=>`<em>${n}</em>`)}function $e(t,e){return e.findIndex(r=>{if(r.indexOf("*")<0)return r===t;let n=r.replace(/[.+?^$|\{\}\(\)\[\]\\]/g,"\\$&");return new RegExp(`^${n.replace(/\*/g,".*")}$`).test(t)})>=0}function T(t,e="<ais-highlight-0000000000>",r="<ais-highlight-0000000000/>",n=[]){let{_source:s={},highlight:o={}}=t,i={...s,...o},c=n.map(a=>M(a).attribute);return Object.keys(i).reduce((a,g)=>{let u=s[g],h=o[g]||null;if(!$e(g,c))return a;if(Array.isArray(u)&&!h)return{...a,[g]:u.map(f=>({matchLevel:"none",matchedWords:[],value:f.toString()}))};if(Array.isArray(u)&&h&&Array.isArray(h))return{...a,[g]:h.map(f=>({fullyHighlighted:!1,matchLevel:"full",matchedWords:Array.from(f.matchAll(/\<em\>(.*?)\<\/em\>/g)).map(y=>y[1]),value:f.toString().replace(/\<em\>/g,e).replace(/\<\/em\>/g,r)}))};if(!Array.isArray(u)&&h&&Array.isArray(h)||!u&&Array.isArray(h)&&h.length>0){let f=h[0],y={fullyHighlighted:!1,matchLevel:"full",matchedWords:Array.from(f.matchAll(/\<em\>(.*?)\<\/em\>/g)).map(d=>d[1]),value:f.toString().replace(/\<em\>/g,e).replace(/\<\/em\>/g,r)};return{...a,[g]:y}}return{...a,[g]:{matchLevel:"none",matchedWords:[],value:u!=null?u.toString():""}}},{})}var Te=(t,e,r)=>{let{hits:n}=t,{highlight_attributes:s=[],snippet_attributes:o=[]}=e;return n.hits.map(i=>{var c,l,a,g,u,h;return{objectID:i._id,_index:i==null?void 0:i._index,...i._source||{},...i.inner_hits?{inner_hits:i.inner_hits}:{},...s.length>0?{_highlightResult:T(i,(c=r==null?void 0:r.params)==null?void 0:c.highlightPreTag,(l=r==null?void 0:r.params)==null?void 0:l.highlightPostTag,s)}:{},...o.length>0?{_snippetResult:T(i,(a=r==null?void 0:r.params)==null?void 0:a.highlightPreTag,(g=r==null?void 0:r.params)==null?void 0:g.highlightPostTag,e.snippet_attributes)}:{},...e.geo_attribute&&((u=i._source)==null?void 0:u[e.geo_attribute])?{_geoloc:ve((h=i._source)==null?void 0:h[e.geo_attribute])}:{}}})};function ve(t){if(typeof t=="string"){let[e,r]=t.split(",").map(n=>parseFloat(n));return{lat:e,lng:r}}else{if(Array.isArray(t))return{lat:t[0],lng:t[1]};if(typeof t=="object"&&"lat"in t&&"lon"in t)return{lat:parseFloat(t.lat),lng:parseFloat(t.lon)}}return null}var je=(t,e)=>{if(!(t!=null&&t.aggregations))return{};let r=Object.keys(t.aggregations).reduce((n,s)=>{let o=(t.aggregations||{})[s];if(s.endsWith(".")){let{doc_count:i,...c}=o;return{...n,...c}}return{...n,[s]:o}},{});return Object.keys(r).reduce((n,s)=>{let o=s.split("$")[0];if(D(e.facet_attributes||[],o)==="numeric"){let l=r[o+"$_stats"],{buckets:a}=r[o+"$_entries"];return{...n,facets:{...n.facets,[o]:a.reduce((g,u)=>({...g,[u.key]:u.doc_count}),{})},facets_stats:{...n.facets_stats,[o]:{min:l.min,avg:l.avg,max:l.max,sum:l.sum}}}}let{buckets:c}=r[o];return{...n,facets:{...n.facets,[o]:c.reduce((l,a)=>({...l,[a.key]:a.doc_count}),{})}}},{facets:{},facets_stats:{}})},Ne=(t,e)=>{var n,s;let r=(n=t.facet_attributes)==null?void 0:n.map(o=>typeof o=="string"?o:o.attribute);return{renderingContent:{facetOrdering:{facets:{order:e.facetAttributesOrder||r||[]},values:(s=t.facet_attributes)==null?void 0:s.reduce((o,i)=>{let c=typeof i=="string"?i:i.attribute;return e.facetAttributesOrder&&!e.facetAttributesOrder.includes(c)?o:{...o,[c]:{sortRemainingBy:"count"}}},{})}}}},ke=(t,e,r)=>{let{params:n={}}=e,{hitsPerPage:s=20,page:o=0}=n,{total:i}=t.hits,c=typeof i=="number"?i:i==null?void 0:i.value,l=s<=0?0:Math.ceil((typeof i=="number"?i:(i==null?void 0:i.value)||0)/s);return{hitsPerPage:s,processingTimeMS:t.took,nbHits:c,page:o,nbPages:l,query:r.query}};function v(t,e,r,n){try{return{appliedRules:n.ruleIds,exhaustiveNbHits:!0,exhaustiveFacetsCount:!0,exhaustiveTypo:!0,exhaustive:{facetsCount:!0,nbHits:!0,typo:!0},...ke(t,e,n),...Ne(r,n),...je(t,r),hits:Te(t,r,e),index:e.indexName,params:new URLSearchParams(e.params).toString(),...n.userData.length>0?{userData:n.userData}:{}}}catch{throw new Error("Error transforming Elasticsearch response for index")}}var G=(t,e)=>{var c,l,a;let r=t.aggregations||{},n=(c=e==null?void 0:e.params)==null?void 0:c.facetName,s=((l=e.params)==null?void 0:l.highlightPreTag)||"<ais-highlight-0000000000>",o=((a=e.params)==null?void 0:a.highlightPostTag)||"<ais-highlight-0000000000/>",i=r[Object.keys(r)[0]];return i&&i[n]&&(i=i[n]),{facetHits:i.buckets.map(g=>({value:g.key,highlighted:V(g.key,e.params.facetQuery||"").replace(/<\em>/g,s).replace(/<\/\em>/g,o),count:g.doc_count})),exhaustiveFacetsCount:!0,processingTimeMS:t.took}};var Be=t=>typeof btoa>"u"?Buffer.from(t.username+":"+t.password).toString("base64"):btoa(t.username+":"+t.password),_=class{constructor(e,r){this.config=e;this.settings=r}createElasticsearchQueryFromRequest(e){return w(e)}async performNetworkRequest(e){return fetch(`${this.config.host}/_msearch`,{headers:{...this.config.apiKey?{authorization:`ApiKey ${this.config.apiKey}`}:{},"content-type":"application/json",...this.config.headers||{},...this.config.auth?{Authorization:"Basic "+Be(this.config.auth)}:{}},body:this.createElasticsearchQueryFromRequest(e),method:"POST"})}async msearch(e){var r,n,s,o,i,c;try{let a=await(await this.performNetworkRequest(e)).json();if(this.settings.debug&&(console.log("Elasticsearch response:"),console.log(JSON.stringify(a))),a.status>=500)throw console.error(JSON.stringify(a)),new Error("Elasticsearch Internal Error: Check your elasticsearch instance to make sure it can recieve requests.");if(a.status===401)throw console.error(JSON.stringify(a)),new Error("Cannot connect to Elasticsearch. Check your connection host and auth details (username/password or API Key required). You can also provide a custom Elasticsearch transporter to the API Client. See https://www.searchkit.co/docs/guides/setup-elasticsearch#connecting-with-usernamepassword for more details.");if(((n=(r=a.responses)==null?void 0:r[0])==null?void 0:n.status)===403)throw console.error(JSON.stringify(a)),new Error("Auth Error: You do not have permission to access this index. Check you are calling the right index (specified in frontend) and your API Key permissions has access to the index.");if(a.status===404||((o=(s=a.responses)==null?void 0:s[0])==null?void 0:o.status)===404)throw console.error(JSON.stringify(a)),new Error("Elasticsearch index not found. Check your index name and make sure it exists.");if(a.status===400||((c=(i=a.responses)==null?void 0:i[0])==null?void 0:c.status)===400)throw console.error(JSON.stringify(a)),new Error(`Elasticsearch Bad Request. 
          
          1. Check your query and make sure it is valid. 
          2. Check the field mapping. See documentation to make sure you are using text types for searching and keyword fields for faceting
          3. Turn on debug mode to see the Elasticsearch query and the error response.
          `);return a.responses}catch(l){throw l}}};var Y=t=>{if(!t)return[];if(typeof t=="string"){let[e,r]=t.split(":");return[{attribute:e,value:r}]}else return t.reduce((e,r)=>{if(typeof r=="string"){let[n,s]=r.split(":");return[...e,{attribute:n,value:s}]}return[...e,...Y(r)]},[])},Z=(t,e,r)=>{var i,c,l;let n={query:((i=e.params)==null?void 0:i.query)||"",context:((c=e.params)==null?void 0:c.ruleContexts)||[],filters:Y((l=e.params)==null?void 0:l.facetFilters)},s=Ie(n,t||[]);return s.reduce((a,g)=>(g.actions.map(u=>{a.touched=!0,u.action==="PinnedResult"?a.pinnedDocs.push(...u.documentIds):u.action==="QueryRewrite"?a.query=u.query:u.action==="QueryBoost"?a.boostFunctions.push({filter:{query_string:{query:E(r.facet_attributes,r.filter_attributes,u.query)}},weight:u.weight}):u.action==="RenderUserData"?a.userData.push(JSON.parse(u.userData)):u.action==="RenderFacetsOrder"?a.facetAttributesOrder=u.facetAttributesOrder:u.action==="QueryFilter"&&a.baseFilters.push({query_string:{query:E(r.facet_attributes,r.filter_attributes,u.query)}})}),a),{ruleIds:s.map(a=>a.id),pinnedDocs:[],boostFunctions:[],query:n.query,userData:[],facetAttributesOrder:void 0,touched:!1,baseFilters:[]})},Ie=(t,e)=>e.filter(r=>r.conditions.find(n=>n.filter(s=>s.context==="query"&&s.match_type==="exact"?s.value===t.query:s.context==="query"&&s.match_type==="contains"?t.query.includes(s.value):s.context==="query"&&s.match_type==="prefix"?t.query.startsWith(s.value):s.context==="context"?s.value.some(o=>t.context.includes(o)):s.context==="filterPresent"?s.values.every(o=>t.filters.find(i=>i.attribute===o.attribute&&i.value===o.value)!==void 0):!1).length===n.length)!==void 0);var P=class{constructor(e,r={debug:!1}){this.config=e;this.settings=r;this.transporter="msearch"in e.connection?e.connection:new _(e.connection,r)}async performSearch(e){try{return this.settings.debug&&(console.log("Performing search with requests:"),console.log("POST /_msearch"),console.log(w(e))),await this.transporter.msearch(e)}catch(r){return console.error(r),[]}}async handleInstantSearchRequests(e,r){var l,a;let n=this.config.search_settings.query_rules||[],s=e.map(g=>Z(n,g,this.config.search_settings)),o=e.map((g,u)=>({body:J(g,this.config.search_settings,s[u],r),request:g,indexName:K(g.indexName,this.config.search_settings)}));(l=r==null?void 0:r.hooks)!=null&&l.beforeSearch&&(o=await r.hooks.beforeSearch(o));let i=await this.performSearch(o);return(a=r==null?void 0:r.hooks)!=null&&a.afterSearch&&(i=await r.hooks.afterSearch(o,i)),{results:i.map((g,u)=>{var h;return(h=e[u].params)!=null&&h.facetName?G(g,e[u]):v(g,e[u],this.config.search_settings,s[u])})}}};return ae(De);})();
var Searchkit = SearchkitDefault.default
//# sourceMappingURL=index.global.js.map